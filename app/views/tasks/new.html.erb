<!-- filepath: c:\Users\DESTOCK\Desktop\Proyecto full stack ruby\task_manager\app\views\tasks\new.html.erb -->
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h1>➕ Nueva Tarea</h1>
      
      <%= form_with(model: @task, local: true) do |form| %>
        <% if @task.errors.any? %>
          <div class="alert alert-danger">
            <h4><%= pluralize(@task.errors.count, "error") %> encontrados:</h4>
            <ul>
              <% @task.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="mb-3">
          <%= form.label :title, "Título" %>
          <%= form.text_field :title, class: 'form-control', placeholder: 'Ej: Completar proyecto' %>
        </div>

        <div class="mb-3">
          <%= form.label :description, "Descripción" %>
          <%= form.text_area :description, class: 'form-control', rows: 4, placeholder: 'Detalles de la tarea...' %>
        </div>

        <div class="mb-3">
          <%= form.label :due_date, "Fecha de Vencimiento" %>
          <%= form.datetime_select :due_date, class: 'form-control' %>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <%= form.label :status, "Estado" %>
            <%= form.select :status, { 'Pendiente' => 'pending', 'En progreso' => 'in_progress', 'Completada' => 'completed' }, {}, class: 'form-select' %>
          </div>

          <div class="col-md-6 mb-3">
            <%= form.label :priority, "Prioridad" %>
            <%= form.select :priority, { 'Baja' => 'low', 'Media' => 'medium', 'Alta' => 'high' }, {}, class: 'form-select' %>
          </div>
        </div>

        <div class="mb-3">
          <%= form.label :category_id, "Categoría" %>
          <%= form.select :category_id, 
                options_for_select(@categories.map { |c| [c.name, c.id] }, @task.category_id), 
                { include_blank: 'Sin categoría' }, 
                class: 'form-select' %>
        </div>

        <div class="d-grid gap-2">
          <%= form.submit "Crear Tarea", class: 'btn btn-success btn-lg' %>
          <%= link_to 'Cancelar', tasks_path, class: 'btn btn-secondary btn-lg' %>
        </div>
      <% end %>
    </div>
  </div>
</div>